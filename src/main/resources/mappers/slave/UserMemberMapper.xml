<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.guoanshequ.dc.das.dao.slave.UserMemberMapper">

	<!-- 根据创建时间从收款表中获取社员信息 -->
	<select id="queryUserMemberByCreateTime" parameterType="java.util.Map" resultType="java.util.Map">
        <![CDATA[
		select 
			tc.id as customer_id,
			torp.store_id as regist_storeid,
			torp.type as member_type,
			tc.mobilephone as mobilephone,
			tc.create_time as regist_time,
			tc.associator_level as associator_level,
			tc.associator_expiry_date as associator_expiry_date
		from t_customer tc
		left join t_order_receipts torp  on (torp.customer_id = tc.id and torp.pay_status ='payed' and (torp.type = 'associator_start_2' OR torp.type = 'associator_up_2' OR torp.type='plus'))
		where ((tc.create_time >=#{begintime} and tc.create_time <=#{endtime} ) 
		or ( tc.update_time >=#{begintime} and tc.update_time <=#{endtime} ))
		and tc.associator_level = 2 
		]]>
	</select>
	
</mapper>